---
title: "final_project_dag"
author: "Stephen Antonoplis"
date: "4/24/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggdag)
```

```{r}
# Version 1 (me alone without Katie)
model1 <- dagify(ScoreThreshhold ~ PM2.5 + Absenteeism + Suspension + MinorityEnrollment + FreeLunch + AirBasin,
                Absenteeism ~ PM2.5 + Suspension + FreeLunch + AirBasin + MinorityEnrollment,
                Suspension ~ PM2.5 + FreeLunch + AirBasin + MinorityEnrollment,
                PM2.5 ~ AirBasin + FreeLunch + MinorityEnrollment,
                FreeLunch ~ MinorityEnrollment,
                exposure='PM2.5',outcome='ScoreThreshhold',
                coords=list(x=c(ScoreThreshhold=1,PM2.5=-2,MinorityEnrollment=-2,FreeLunch=-1,AirBasin=0,
                                Suspension=-1,Absenteeism=-0.5),
                            y=c(ScoreThreshhold=-2,PM2.5=-0.5,MinorityEnrollment=2,FreeLunch=1.5,AirBasin=2,
                                Suspension=-2,Absenteeism=-1.5))
                )
ggdag(model1,node=FALSE,text_col='black')
ggdag_adjustment_set(model1,text_col='black')
```

```{r}
# Version 2 (after talking to Katie)
  # construction rules:
  # - observed indicators entered into equations before unobserved indicators
  # - observed indicators grouped on separate line from unobserved indicators
  # - after adding an unobserved indicator to an equation, immediately add it to the "latent" parameter before altering further equations
  # - enter only *direct* causes of a variable into its equation
  # - make equations for observed variables first, then for unobserved variables
  # - enter associations between variables on the line following the equation for the variable and indented
  # - observed variables = PM2.5, Scores, Absenteeism, Suspension, FreeLunch, MinorityPerc, ESL, AirBasin, PerCapEduFund
model2 <- dagify(PM2.5 ~ PolicyInfluence + LandUsePolicy + GeoFeat + AirPolicy,
                Scores ~ PM2.5 + Absenteeism + Suspension + FreeLunch + ESL + AirBasin + PerCapEduFund +
                         TeacherDiscrim + TeacherQual,
                Absenteeism ~ PM2.5 + Suspension,
                Suspension ~ PM2.5 + 
                             TeacherDiscrim,
                FreeLunch ~ HouseIncome,
                MinorityPerc ~ LandUsePolicy,
                ESL ~ FamSpeakEng,
                AirBasin ~ GeoFeat,
                PerCapEduFund ~ LandUsePolicy + LocalPropertyTax,
                
                PolicyInfluence ~ MinorityPerc + 
                                  FamSpeakEng + HouseIncome,
                #LandUsePolicy ~ ,
                #GeoFeat ~ ,
                AirPolicy ~ AirBasin,
                TeacherDiscrim ~ MinorityPerc,
                TeacherQual ~ PerCapEduFund,
                HouseIncome ~ MinorityPerc + LandUsePolicy + FamSpeakEng,
                FamSpeakEng ~ MinorityPerc,
                LocalPropertyTax ~ HouseIncome,
                exposure="PM2.5",outcome="Scores",
                latent=c("PolicyInfluence","LandUsePolicy","GeoFeat","AirPolicy","TeacherDiscrim","TeacherQual","HouseIncome","FamSpeakEng","LocalPropertyTax"),
                coords=list(x=c(PM2.5=-5,Scores=4,Absenteeism=-1.5,Suspension=-2,FreeLunch=2,MinorityPerc=-5,ESL=2,AirBasin=-1,PerCapEduFund=3.5,
                                PolicyInfluence=-5,LandUsePolicy=0,GeoFeat=-2.6,AirPolicy=-2.35,TeacherDiscrim=.75,TeacherQual=3.75,HouseIncome=0,FamSpeakEng=1,LocalPropertyTax=1.25),
                            y=c(PM2.5=-0.5,Scores=-2,Absenteeism=-1.5,Suspension=-2.5,FreeLunch=1,MinorityPerc=5,ESL=3.5,AirBasin=0.75,PerCapEduFund=4,
                                PolicyInfluence=3,LandUsePolicy=6,GeoFeat=0,AirPolicy=-0.25,TeacherDiscrim=0.25,TeacherQual=3,HouseIncome=1.5,FamSpeakEng=4.25,LocalPropertyTax=2.25))
                )
ggdag(model2,node=FALSE,text_col="black")
ggdag_adjustment_set(model2,text_col="black")
```

```{r}
# Version 3 (beautifying Version 2)
  # construction rules:
  # - observed indicators entered into equations before unobserved indicators
  # - observed indicators grouped on separate line from unobserved indicators
  # - after adding an unobserved indicator to an equation, immediately add it to the "latent" parameter before altering further equations
  # - enter only *direct* causes of a variable into its equation
  # - make equations for observed variables first, then for unobserved variables
  # - enter associations between variables on the line following the equation for the variable and indented
  # - observed variables = PM2.5, Scores, Absenteeism, Suspension, FreeLunch, MinorityPerc, ESL, AirBasin, PerCapEduFund
model3 <- dagify(PM2.5 ~ PolicyInfluence + LandUsePolicy + GeoFeat + AirPolicy,
                Scores ~ PM2.5 + Absenteeism + Suspension + FreeLunch + ESL + AirBasin + PerCapEduFund +
                         TeacherDiscrim + TeacherQual,
                Absenteeism ~ PM2.5 + Suspension,
                Suspension ~ PM2.5 + 
                             TeacherDiscrim,
                FreeLunch ~ HouseIncome,
                MinorityPerc ~ LandUsePolicy,
                ESL ~ FamSpeakEng,
                AirBasin ~ GeoFeat,
                PerCapEduFund ~ LandUsePolicy + LocalPropertyTax,
                
                PolicyInfluence ~ MinorityPerc + 
                                  FamSpeakEng + HouseIncome,
                #LandUsePolicy ~ ,
                #GeoFeat ~ ,
                AirPolicy ~ AirBasin,
                TeacherDiscrim ~ MinorityPerc,
                TeacherQual ~ PerCapEduFund,
                HouseIncome ~ MinorityPerc + LandUsePolicy + FamSpeakEng,
                FamSpeakEng ~ MinorityPerc,
                LocalPropertyTax ~ HouseIncome,
                exposure="PM2.5",outcome="Scores",
                latent=c("PolicyInfluence","LandUsePolicy","GeoFeat","AirPolicy","TeacherDiscrim","TeacherQual","HouseIncome","FamSpeakEng","LocalPropertyTax"),
                coords=list(x=c(PM2.5=-5,Scores=4,Absenteeism=-1.5,Suspension=-2,FreeLunch=1.75,MinorityPerc=-5,ESL=2,AirBasin=-2.35,PerCapEduFund=3.5,
                                PolicyInfluence=-5,LandUsePolicy=-1,GeoFeat=-3,AirPolicy=-2.75,TeacherDiscrim=0,TeacherQual=3.75,HouseIncome=0.75,FamSpeakEng=1,LocalPropertyTax=1.75),
                            y=c(PM2.5=-0.5,Scores=-2,Absenteeism=-1.5,Suspension=-2.5,FreeLunch=0.8,MinorityPerc=5,ESL=3.5,AirBasin=0.75,PerCapEduFund=4,
                                PolicyInfluence=4,LandUsePolicy=6,GeoFeat=0,AirPolicy=-0.25,TeacherDiscrim=0.25,TeacherQual=3,HouseIncome=1.3,FamSpeakEng=4.25,LocalPropertyTax=2.05))
                )
ggdag(model3,node=FALSE,text_col="black")
ggdag_adjustment_set(model3,text_col="black")
```

